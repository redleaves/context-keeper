# Context-Keeper 环境变量配置模板
# =================================
# 基础服务配置
# =================================
SERVICE_NAME=context-keeper
PORT=8088
DEBUG=false
STORAGE_PATH=./data

# =================================
# 阿里云文本嵌入服务配置
# =================================
EMBEDDING_API_URL=https://dashscope.aliyuncs.com/compatible-mode/v1/embeddings
EMBEDDING_API_KEY=

# 🔥 批量Embedding配置
BATCH_EMBEDDING_API_URL=https://dashscope.aliyuncs.com/api/v1/services/embeddings/text-embedding/text-embedding
BATCH_EMBEDDING_API_KEY=
BATCH_QUEUE_SIZE=100
BATCH_WORKER_POLL_INTERVAL=5s
BATCH_MAX_RETRIES=100

# =================================
# 向量存储配置
# =================================

# 向量存储类型选择: aliyun | vearch
VECTOR_STORE_TYPE=aliyun
USER_REPOSITORY_TYPE=aliyun


# 阿里云dashVector 向量数据库配置
VECTOR_DB_URL=https://vrs-cn-hic4apgaa00049.dashvector.cn-hangzhou.aliyuncs.com
VECTOR_DB_API_KEY=
VECTOR_DB_COLLECTION=context_keeper
VECTOR_DB_DIMENSION=1536
VECTOR_DB_METRIC=cosine
SIMILARITY_THRESHOLD=0.3

# =================================
# 京东云Vearch 向量数据库配置
# =================================
VEARCH_URL=http://context-keeper.vearch.jd.local
VEARCH_USERNAME=
VEARCH_PASSWORD=
VEARCH_DATABASE=db
VEARCH_DIMENSION=1536
VEARCH_METRIC=inner_product
VEARCH_SIMILARITY_THRESHOLD=0.2

# Vearch 必需的表空间列表（逗号分隔，启动时检查）
VEARCH_REQUIRED_SPACES=context_keeper_vector,context_keeper_users

# Vearch 性能配置
VEARCH_CONNECTION_POOL_SIZE=10
VEARCH_REQUEST_TIMEOUT=30
VEARCH_DEFAULT_TOP_K=10

# =================================
# 时间阈值配置 (新增)
# =================================

# 会话管理相关
SESSION_TIMEOUT=120m            # 会话超时时间，默认30分钟
CLEANUP_INTERVAL=10m           # 后台清理任务执行间隔，默认10分钟  
SHORT_MEMORY_MAX_AGE=3         # 短期记忆保留天数，默认2天

# 自动汇总相关
SUMMARY_INTERVAL_MULTIPLIER=5  # 自动汇总间隔倍数（相对于清理间隔），默认5倍
MIN_MESSAGE_COUNT=20           # 最小消息数阈值，少于此数量不汇总，默认20
MIN_TIME_SINCE_LAST_SUMMARY=24 # 距离上次汇总的最小小时数，默认24小时
MAX_MESSAGE_COUNT=100          # 触发汇总的消息数阈值，默认100
